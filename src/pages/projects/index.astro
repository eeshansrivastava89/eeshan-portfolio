---
/**
 * Projects Index Page
 * Lists all projects with full ProjectCard and upcoming timeline
 */
import PageLayout from '../../layouts/BaseLayout.astro'
import Section from '../../components/Section.astro'
import Breadcrumbs from '../../../packages/shared/src/components/Breadcrumbs.astro'

import { getLiveProjects, getProjectsByStatus } from '../../../packages/shared/src/lib/projects'
import { getAllProjects } from '../../../packages/shared/src/data/projectLoader'
import ProjectCard from '../../../packages/shared/src/components/ProjectCard.astro'
import Timeline from '../../../packages/shared/src/components/Timeline.astro'

const allProjects = getAllProjects()
const liveProjects = getLiveProjects(allProjects)
const inProgressProjects = getProjectsByStatus(allProjects, 'in-progress')
const activeProjects = [...liveProjects, ...inProgressProjects] // Cards for live + in-progress
const upcomingProjects = getProjectsByStatus(allProjects, 'coming-soon')
---

<PageLayout meta={{ title: 'Projects' }}>
	<div class='flex w-full flex-col gap-y-10'>
		<Breadcrumbs currentLabel="Projects" />
		<Section title='Projects'>
			<p class='text-base text-muted-foreground'>
				Each project applies a data science method to a real problem, generates real user data (non-identifiable of course), and is supported by published research you can dive into. Want to build alongside? <a href='/contribute' class='underline hover:text-foreground'>Contribute</a> a new project or improve an existing one.
			</p>
		</Section>

		{activeProjects.length > 0 && (
			<Section title='Active'>
				<div class='space-y-4'>
					{activeProjects.map((project) => (
						<ProjectCard project={project} variant='full' />
					))}
				</div>
			</Section>
		)}

		{upcomingProjects.length > 0 && (
			<Section title="What's Next">
				<Timeline 
					inProgressProjects={[]} 
					upcomingProjects={upcomingProjects}
					title=""
				/>
			</Section>
		)}
	</div>
</PageLayout>
